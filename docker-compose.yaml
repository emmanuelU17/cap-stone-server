version: '3.9'
services:

  api:
    container_name: api
    image: "emmanuelu17/webserver:latest"
    ports:
      - "1997:1997"
    depends_on:
      mysql:
        condition: service_healthy
    environment:
      USER_PRINCIPAL: french@admin.com
      USER_PASSWORD: password
      PORT: 1997
      SPRING_PROFILES_ACTIVE:
      DB_DOMAIN: "mysql"
      DH_HOST: 3306
      DB_NAME: sara_brand_db
      SPRING_DATASOURCE_USERNAME: sara
      SPRING_DATASOURCE_PASSWORD: sara
      SARRE_USD_TO_CENT: 100
      SARRE_NGN_TO_KOBO: 0.37
      PAYSTACK_PUB_KEY: "public key"
      PAYSTACK_SECRET_KEY: "you tried it haha"
      CORS_UI_DOMAIN: http://localhost:4200/

  mysql:
    image: "mysql:8.0"
    container_name: mysql
    ports:
      - "3306:3306"
    environment:
      MYSQL_ROOT_PASSWORD: sara
      MYSQL_DATABASE: sara_brand_db
      MYSQL_USER: sara
      MYSQL_PASSWORD: sara
    healthcheck:
      test: [ "CMD-SHELL", "mysqladmin ping -h localhost" ]
      interval: 10s
      timeout: 5s
      retries: 5
    volumes:
      - db-data:/var/lib/mysql

volumes:
  db-data: {}

# SPRING_DATASOURCE_URL: jdbc:mysql://mysql:3306/sara_brand_db